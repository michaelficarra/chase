\section{The Chase}

	The \emph{chase} is a function that, when given a geometric theory, will
	generate a set of jointly minimal models for that theory. More
	specifically, if $\mathcal{U}$ is the set of all models obtained from an
	execution of the chase over a geometric theory $T$, for any model
	$\mathbb{M}$ such that $\mathbb{M} \models T$, there is a homomorphism from
	some model $\mathbb{U} \in \mathcal{U}$ to $\mathbb{M}$.

	Geometric logic formul{\ae} are used by the chase because they have the
	useful property where adding any relations or domain members to a model
	that satisfies a geometric logic formula will never cause the formula to no
	longer be satisfied. This is particularly helpful when trying to create a
	model that satisfies all formul{\ae} in a geometric theory.

	There are three types of runs of the chase:
	\begin{itemize}
	\item a set of jointly minimal models is found in finite time
	\item an empty result is found in finite time
	\item an infinite run with possible return dependent on implementation
	\end{itemize}

	\subsection{Algorithm}

		The chase starts with a model $\mathbb{M}$ that has an empty domain and
		an empty set of facts. While there is a formula $\sigma$ in the input
		theory $T$ such that $\mathbb{M} \not\models \sigma$, perform a
		\emph{chase correction}.

		A \emph{chase correction} performs the following steps:
		\begin{enumerate}
		\item choose formula $\sigma \in T$ such that $\mathbb{M} \not\models \sigma$
		\item split this formula into the left and right sides of its implication, $\alpha$ and $\beta$
		\item if $\beta$ is a contradiction, halt with failure
		\item a binding $\lambda$ is chosen such that $\mathbb{M} \models_\lambda \alpha$
		\item if $\beta$ contains a disjunction, choose a disjunct and assign it to $\beta$
		\item add a new domain member to the domain for every free variable not in the domain of $\lambda$
		\item for every new domain element $e$ and the variable $v$ for which it was added, redefine $\lambda$ as $\lambda_{v \mapsto e}$
		\item for every atomic $R$, replace each variable $v$ with $\lambda(v)$ and add it to the model
		\end{enumerate}

		If no formula $\sigma$ exists such that $\mathbb{M} \not\models
		\sigma$, halt with result $\mathbb{M}$.

	\subsection{Examples}

		Define $\Sigma$ as the following geometric theory.

		\begin{eqnarray}
			\top    &  \to  &  \exists\ x,y : R(x,y)                             \\
			R(x,y)  &  \to  &  (\exists\ z : Q(x,z)) \vee P                      \\
			Q(x,y)  &  \to  &  (\exists\ z : R(x,z)) \vee (\exists\ z : R(z,y))  \\
			P       &  \to  &  \bot
		\end{eqnarray}

		The following three chase runs show the different types of results
		depending on which disjunct the algorithm attempts to satisfy when a
		disjunction is encountered.

		\begin{enumerate}
		\item A non-empty result in finite time:

			\begin{tabular}{lllllll}
				$\emptyset$ & $\mapsto$ & \{ & $a,b$   & $|$ & $R(a,b)$         & \} \\
				{}          & $\mapsto$ & \{ & $a,b,c$ & $|$ & $R(a,b), Q(a,c)$ & \}
			\end{tabular}

			Since the left side of \textbf{(1)} is always satisfied, but its
			right side is not, domain members $a$ and $b$ and fact $R(a,b)$ are
			added to the initially empty model to satisfy \textbf{(1)}. The
			left side of \textbf{(2)} holds, but the right side does not, so
			one of the disjuncts $\exists\ z : Q(x,z)$ or $P(x)$ is chosen to
			be satisfied. Assuming the left operand is chosen, $x$ will already
			have been assigned to $a$ and a new domain member $c$ and a new
			fact $Q(a,c)$ will be added to satisfy \textbf{(2)}. With the
			current model, all rules hold under any environment. Therefore,
			this model is minimal.

		\item An empty result in finite time:

			\begin{tabular}{lllllll}
				$\emptyset$ & $\mapsto$ & \{ & $a,b$   & $|$ & $R(a,b)$               & \} \\
				{}          & $\mapsto$ & \{ & $a,b,c$ & $|$ & $R(a,b), P(a,c)$       & \} \\
				{}          & $\mapsto$ & \{ & $a,b,c$ & $|$ & $R(a,b), P(a,c), \bot$ & \} \\
				{}          & $\mapsto$ & \multicolumn{5}{l}{ $\varepsilon$ }
			\end{tabular}

			Again, domain members $a$ and $c$ and fact $R(a,b)$ are added to
			the initial model to satisfy \textbf{(1)}. This time, when
			attempting to satisfy \textbf{(2)}, the right side is chosen and
			$P$ is added to the set of facts. After adding this new fact, rule
			\textbf{(4)} no longer holds; its left side is satisfied, but its
			right side does not hold for all of the bindings for which it is
			satisfied. When we attempt to satisfy the right side of
			\textbf{(4)}, it is found to be a contradiction and therefore
			unsatisfiable. Since this model can never satisfy this theory, the
			chase fails.

		\item An infinite run:

			\begin{tabular}{lllllll}
				$\emptyset$ & $\mapsto$ & \{ & $a,b$        & $|$ & $R(a,b)$                                 & \} \\
				{}          & $\mapsto$ & \{ & $a,b,c$      & $|$ & $R(a,b), Q(a,c)$                         & \} \\
				{}          & $\mapsto$ & \{ & $a,\ldots,d$ & $|$ & $R(a,b), Q(a,c), R(d,c)$                 & \} \\
				{}          & $\mapsto$ & \{ & $a,\ldots,e$ & $|$ & $R(a,b), Q(a,c), R(d,c), Q(d,e)$         & \} \\
				{}          & $\mapsto$ & \{ & $a,\ldots,f$ & $|$ & $R(a,b), Q(a,c), R(d,c), Q(d,e), R(f,e)$ & \} \\
				{}          & $\mapsto$ & \multicolumn{5}{l}{ $\ldots$ }
			\end{tabular}

			Like in the example above that returned a non-empty, finite result,
			the first two steps add domain members $a$, $b$, and $c$ and facts
			$R(a,b)$ and $Q(a,c)$. The left side of the implication in
			\textbf{(3)} now holds, but the right side does not. In order to
			make the right side hold, one of the disjuncts needs to be
			satisfied. If the right disjunct is chosen, a new domain member $d$
			and a new relation $R(d,c)$ will be added. This will cause the
			left side of the implication in \textbf{(2)} to hold for $R(d,c)$,
			but the right side will no hold for the same binding. $Q(d,e)$ will
			be added, and this loop will continue indefinitely unless a
			different disjunct is chosen in \textbf{(2)} or \textbf{(3)}.

		\end{enumerate}

	\subsection{Joint Minimality Theorems}

		\newtheorem{minimality-theorems}{Theorem}

		\begin{minimality-theorems}
			A geometric theory $T$ is satisfiable if and only if there is a
			chase run of $T$ that returns a non-empty result.
			\textbf{ do infinite runs imply satisfiability? }
		\end{minimality-theorems}

		\begin{minimality-theorems}
			Let $\mathcal{M}$ be the set of models returned from all successful
			runs of the chase over a geometric theory $T$. For any model
			$\mathbb{N}$ such that $\mathbb{N} \models T$, there is a model
			$\mathbb{M} \in \mathcal{M}$ such that $\mathbb{M} \preceq
			\mathbb{N}$. $\mathcal{M}$ is jointly minimal.
		\end{minimality-theorems}
